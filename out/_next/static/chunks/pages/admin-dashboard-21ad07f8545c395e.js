(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[897],{3259:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin-dashboard",function(){return t(3102)}])},3102:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return n}});var s=t(5893),r=t(7294),l=t(1163);function n(){let[e,a]=(0,r.useState)([]),[t,n]=(0,r.useState)(null),[i,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(!1),[m,u]=(0,r.useState)({id:e.id,name:"",address:"",email:"",mobile:"",whatsapp:"",facebook:"",instagram:"",twitter:"",designation:"",companyName:"",website:"",linkedin:"",profilePicture:null,backgroundPhoto:null}),h=(0,l.useRouter)();(0,r.useEffect)(()=>{let e=sessionStorage.getItem("token");console.log("checking token "),e||(console.log("not find checking token "),h.push("/admin"))},[h]),(0,r.useEffect)(()=>{(async()=>{let e=await fetch("/api/get-user-profiles");a((await e.json()).users)})()},[]);let x=async(t,s)=>{let r=!s;(await fetch("/api/update-user-status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t,active:r})})).ok?a(e.map(e=>e.id===t?{...e,active:r}:e)):console.error("Failed to update user status")},b=e=>{n({...e}),u({id:e.id,name:e.name,address:e.address,email:e.email,mobile:e.mobile,whatsapp:e.whatsapp,facebook:e.facebook,instagram:e.instagram,twitter:e.twitter,designation:e.designation,companyName:e.companyName,website:e.website,linkedin:e.linkedin,profilePicture:null,backgroundPhoto:null}),o(!0)},p=async()=>{let t=new FormData;for(let e in m)t.append(e,m[e]);let s=await fetch("/api/update-user",{method:"POST",body:t});if(s.ok){let t=await s.json();a(e.map(e=>e.id===t.id?t:e)),o(!1),y()}else console.error("Failed to update user")},g=e=>{let{name:a,type:t}=e.target;if("file"===t){if(e.target.files&&e.target.files.length>0){let t=e.target.files[0],s=new FileReader;s.onloadend=()=>{n(e=>({...e,[a]:s.result})),u(e=>({...e,[a]:t}))},s.readAsDataURL(t)}}else u({...m,[a]:e.target.value}),n(t=>({...t,[a]:e.target.value})),c(!0)},f=async t=>{setTimeout(()=>{window.location.reload()},2e3);let s=await fetch("/api/delete-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t})});if(y(),s.ok){let r=await s.json();a(e.filter(e=>e.id!==t)),o(!1),console.log(r.message)}else console.error("Failed to delete user:",(await s.json()).error)},y=()=>{window.location.reload()};return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-100 p-6",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-center text-gray-800 mb-6",children:"Admin Dashboard"}),(0,s.jsx)("div",{className:"flex justify-end mb-4",children:(0,s.jsx)("button",{onClick:y,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition duration-200",children:"Refresh"})}),(0,s.jsx)("div",{className:"overflow-auto bg-white rounded-lg shadow-md",children:(0,s.jsxs)("table",{className:"min-w-full bg-white border border-gray-300",children:[(0,s.jsx)("thead",{className:"bg-gray-200",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"border px-4 py-2 text-left text-gray-600",children:"Name"}),(0,s.jsx)("th",{className:"border px-4 py-2 text-left text-gray-600",children:"Address"}),(0,s.jsx)("th",{className:"border px-4 py-2 text-left text-gray-600",children:"Mobile"}),(0,s.jsx)("th",{className:"border px-4 py-2 text-left text-gray-600",children:"Email"}),(0,s.jsx)("th",{className:"border px-4 py-2 text-left text-gray-600",children:"Status"}),(0,s.jsx)("th",{className:"border px-4 py-2 text-left text-gray-600",children:"Action"})]})}),(0,s.jsx)("tbody",{children:e.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-100 transition duration-200",children:[(0,s.jsx)("td",{className:"border px-4 py-2",children:e.name}),(0,s.jsx)("td",{className:"border px-4 py-2",children:e.address}),(0,s.jsx)("td",{className:"border px-4 py-2",children:e.mobile}),(0,s.jsx)("td",{className:"border px-4 py-2",children:e.email}),(0,s.jsx)("td",{className:"border px-4 py-2",children:e.active?"Active":"Inactive"}),(0,s.jsxs)("td",{className:"border px-4 py-2",children:[(0,s.jsx)("button",{onClick:()=>x(e.id,e.active),className:"py-1 px-2 rounded transition duration-200 ".concat(e.active?"bg-red-500 text-white hover:bg-red-600":"bg-green-500 text-white hover:bg-green-600"),children:e.active?"Deactivate":"Activate"}),(0,s.jsx)("button",{onClick:()=>b(e),className:"ml-4 py-1 px-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition duration-200",children:"Show More Info"})]})]},e.id))})]})}),i&&t&&(0,s.jsx)("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex justify-center items-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-3xl overflow-y-auto max-h-screen",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"User Information"}),(0,s.jsxs)("form",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium",children:"Name:"}),(0,s.jsx)("input",{type:"text",name:"name",className:"border border-gray-300 rounded-md p-2 w-full",value:t.name,onChange:g})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium",children:"Address:"}),(0,s.jsx)("input",{type:"text",name:"address",className:"border border-gray-300 rounded-md p-2 w-full",value:t.address,onChange:g})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium",children:"Mobile:"}),(0,s.jsx)("input",{type:"text",name:"mobile",className:"border border-gray-300 rounded-md p-2 w-full",value:t.mobile,onChange:g})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium",children:"Whatsapp Number:"}),(0,s.jsx)("input",{type:"text",name:"whatsapp",className:"border border-gray-300 rounded-md p-2 w-full",value:t.whatsapp,onChange:g})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium",children:"Email:"}),(0,s.jsx)("input",{type:"email",name:"email",className:"border border-gray-300 rounded-md p-2 w-full",value:t.email,onChange:g})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium",children:"Designation:"}),(0,s.jsx)("input",{type:"text",name:"designation",className:"border border-gray-300 rounded-md p-2 w-full",value:t.designation,onChange:g})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium",children:"Company Name:"}),(0,s.jsx)("input",{type:"text",name:"companyName",className:"border border-gray-300 rounded-md p-2 w-full",value:t.companyName,onChange:g})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium",children:"Profile Picture:"}),(0,s.jsx)("input",{type:"file",name:"profilePicture",accept:"image/*",className:"border border-gray-300 rounded-md p-2 w-full",onChange:g})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium",children:"Background Photo:"}),(0,s.jsx)("input",{type:"file",name:"backgroundPhoto",accept:"image/*",className:"border border-gray-300 rounded-md p-2 w-full",onChange:g})]})]}),(0,s.jsxs)("div",{className:"mt-4 flex justify-end",children:[(0,s.jsx)("button",{onClick:p,className:" ".concat(d?"bg-yellow-400 text-black rounded hover:bg-yellow-600   hover:text-white":"bg-green-500 text-white rounded hover:bg-green-600"," px-4 py-2 transition duration-200"),children:"Update User"}),(0,s.jsx)("button",{onClick:()=>f(t.id),className:"ml-2 bg-red-500 text-white rounded px-4 py-2 hover:bg-red-600 transition duration-200",children:"Delete User"}),(0,s.jsx)("button",{onClick:()=>{o(!1),c(!1)},className:"ml-2 bg-gray-300 text-gray-700 rounded px-4 py-2 hover:bg-gray-400 transition duration-200",children:"Close"})]})]})})]})}},1163:function(e,a,t){e.exports=t(3079)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=3259)}),_N_E=e.O()}]);