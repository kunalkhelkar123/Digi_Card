(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[897],{3259:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin-dashboard",function(){return a(3102)}])},3102:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return n}});var s=a(5893),r=a(7294),l=a(1163);function n(){let[e,t]=(0,r.useState)([]),[a,n]=(0,r.useState)(null),[d,i]=(0,r.useState)(!1),[o,c]=(0,r.useState)(!1),[m,u]=(0,r.useState)({id:"",name:"",address:"",email:"",mobile:"",whatsapp:"",facebook:"",instagram:"",twitter:"",designation:"",companyName:"",website:"",linkedin:"",profilePicture:null,backgroundPhoto:null}),[x,h]=(0,r.useState)("yearly"),[p,b]=(0,r.useState)(""),[g,y]=(0,r.useState)(""),[f,j]=(0,r.useState)(""),N=(0,l.useRouter)();(0,r.useEffect)(()=>{sessionStorage.getItem("token")||N.push("/admin")},[N]),(0,r.useEffect)(()=>{(async()=>{let e=await fetch("/api/get-user-profiles");t((await e.json()).users)})()},[]);let w=async(a,s)=>{let r=!s;(await fetch("/api/update-user-status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a,active:r})})).ok?t(e.map(e=>e.id===a?{...e,active:r}:e)):console.error("Failed to update user status")},v=e=>{n({...e}),u({id:e.id,name:e.name,userName:e.userName,address:e.address,email:e.email,mobile:e.mobile,whatsapp:e.whatsapp,facebook:e.facebook,instagram:e.instagram,twitter:e.twitter,designation:e.designation,companyName:e.companyName,website:e.website,linkedin:e.linkedin,profilePicture:null,backgroundPhoto:null}),i(!0)},k=async()=>{let a=new FormData;for(let e in m)a.append(e,m[e]);let s=await fetch("/api/update-user",{method:"POST",body:a});if(s.ok){let a=await s.json();t(e.map(e=>e.id===a.id?a:e)),i(!1),window.location.reload()}else console.error("Failed to update user")},C=e=>{let{name:t,type:a}=e.target;if("file"===a){if(e.target.files&&e.target.files.length>0){let a=e.target.files[0],s=new FileReader;s.onloadend=()=>{n(e=>({...e,[t]:s.result})),u(e=>({...e,[t]:a}))},s.readAsDataURL(a)}}else u({...m,[t]:e.target.value}),n(a=>({...a,[t]:e.target.value})),c(!0)},D=async a=>{let s=await fetch("/api/delete-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a})});if(s.ok){let r=await s.json();window.location.reload(),t(e.filter(e=>r.id!==a)),i(!1)}else console.error("Failed to delete user:",(await s.json()).error)};new Date().toLocaleDateString();let S=e.filter(e=>{let t=new Date(e.registrationDate),a=new Date;switch(x){case"daily":return t.toDateString()===new Date(p).toDateString();case"weekly":let s=new Date(a);return s.setDate(a.getDate()-a.getDay()),t>=s&&t<=a;case"monthly":return t.getMonth()===a.getMonth()&&t.getFullYear()===a.getFullYear();case"yearly":return t.getFullYear()===a.getFullYear();case"custom":let r=new Date(g),l=new Date(f);return t>=r&&t<=l;default:return!0}});return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-100 p-6 ",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-center text-gray-800 mb-6",children:"Admin Dashboard"}),(0,s.jsx)("div",{className:"flex justify-end mb-4",children:(0,s.jsx)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition duration-200",children:"Refresh"})}),(0,s.jsxs)("div",{className:"mb-4 flex space-x-2",children:[(0,s.jsxs)("select",{value:x,onChange:e=>{h(e.target.value),"custom"!==e.target.value&&(y(""),j(""),b(""))},className:"p-2 border border-gray-300 rounded",children:[(0,s.jsx)("option",{value:"daily",children:"Date Wise"}),(0,s.jsx)("option",{value:"weekly",children:"Weekly"}),(0,s.jsx)("option",{value:"monthly",children:"Monthly"}),(0,s.jsx)("option",{value:"yearly",children:"Yearly"}),(0,s.jsx)("option",{value:"custom",children:"Custom Date Range"})]}),"daily"===x&&(0,s.jsx)("input",{type:"date",value:p,onChange:e=>b(e.target.value),className:"p-2 border border-gray-300 rounded"}),"custom"===x&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{type:"date",value:g,onChange:e=>y(e.target.value),className:"p-2 border border-gray-300 rounded"}),(0,s.jsx)("input",{type:"date",value:f,onChange:e=>j(e.target.value),className:"p-2 border border-gray-300 rounded"})]})]}),(0,s.jsx)("div",{className:"overflow-x-auto bg-white rounded-lg shadow-md",children:(0,s.jsxs)("table",{className:"min-w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{style:{backgroundColor:"lightgray"},children:[(0,s.jsx)("th",{className:"border px-2 py-2 text-sm text-left text-black",children:"Sr. No"}),(0,s.jsx)("th",{className:"border px-2 py-2 text-sm text-left text-balck",children:"Name"}),(0,s.jsx)("th",{className:"border px-2 py-2 text-sm text-left text-black",children:"Address"}),(0,s.jsx)("th",{className:"border px-2 py-2 text-left text-sm  text-black",children:"Mobile"}),(0,s.jsx)("th",{className:"border px-2 py-2  text-sm text-left text-black",children:"Email"}),(0,s.jsx)("th",{className:"border px-2 py-2  text-sm text-left text-black",children:"Registration Date"}),(0,s.jsx)("th",{className:"border px-2 py-2 text-sm  text-left text-black",children:"Status"}),(0,s.jsx)("th",{className:"border px-24 py-2 text-sm  text-left text-black",children:"Action"})]})}),(0,s.jsx)("tbody",{children:S.map((e,t)=>(0,s.jsxs)("tr",{className:"hover:bg-gray-100 transition duration-200",children:[(0,s.jsx)("td",{className:"border text-sm w-10 px-2 py-2",children:t+1}),(0,s.jsx)("td",{className:"border text-sm  px-2 py-2",children:e.name}),(0,s.jsx)("td",{className:"border text-sm w-80  px-2 py-2",children:e.address}),(0,s.jsx)("td",{className:"border text-sm w-30  px-2 py-2",children:e.mobile}),(0,s.jsx)("td",{className:"border text-sm w-30  px-2 py-2",children:e.email}),(0,s.jsx)("td",{className:"border text-sm w-12  px-2 py-2",children:e.registrationDate}),(0,s.jsx)("td",{className:"border text-sm  px-2 py-2",children:e.active?"Active":"Inactive"}),(0,s.jsxs)("td",{className:"border text-sm  px-2 py-2",children:[(0,s.jsx)("button",{onClick:()=>w(e.id,e.active),className:"py-1 px-1 rounded transition duration-200 ".concat(e.active?"bg-red-500 text-white hover:bg-red-600":"bg-green-500 text-white hover:bg-green-600"),children:e.active?"Deactivate":"Activate"}),(0,s.jsx)("button",{onClick:()=>v(e),className:"ml-2 py-1 px-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition duration-200",children:"Show More Info"}),(0,s.jsx)("button",{onClick:()=>D(e.id),className:"ml-2 py-1 px-1 bg-red-500 text-white rounded hover:bg-red-600 transition duration-200",children:"Delete"})]})]},e.id))})]})}),d&&a&&(0,s.jsx)("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex justify-center items-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-3xl overflow-y-auto max-h-screen",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"User Information"}),(0,s.jsxs)("form",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium",children:"Name:"}),(0,s.jsx)("input",{type:"text",name:"name",className:"border border-gray-300 rounded-md p-2 w-full",value:a.name,onChange:C})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium",children:"UserName:"}),(0,s.jsx)("input",{type:"text",name:"userName",className:"border border-gray-300 rounded-md p-2 w-full",value:a.userName,onChange:C})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium",children:"Address:"}),(0,s.jsx)("input",{type:"text",name:"address",className:"border border-gray-300 rounded-md p-2 w-full",value:a.address,onChange:C})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium",children:"Mobile:"}),(0,s.jsx)("input",{type:"text",name:"mobile",className:"border border-gray-300 rounded-md p-2 w-full",value:a.mobile,onChange:C})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium",children:"Whatsapp Number:"}),(0,s.jsx)("input",{type:"text",name:"whatsapp",className:"border border-gray-300 rounded-md p-2 w-full",value:a.whatsapp,onChange:C})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium",children:"Email:"}),(0,s.jsx)("input",{type:"email",name:"email",className:"border border-gray-300 rounded-md p-2 w-full",value:a.email,onChange:C})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium",children:"Designation:"}),(0,s.jsx)("input",{type:"text",name:"designation",className:"border border-gray-300 rounded-md p-2 w-full",value:a.designation,onChange:C})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium",children:"Company Name:"}),(0,s.jsx)("input",{type:"text",name:"companyName",className:"border border-gray-300 rounded-md p-2 w-full",value:a.companyName,onChange:C})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium",children:"Profile Picture:"}),(0,s.jsx)("input",{type:"file",name:"profilePicture",accept:"image/*",className:"border border-gray-300 rounded-md p-2 w-full",onChange:C})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium",children:"Background Photo:"}),(0,s.jsx)("input",{type:"file",name:"backgroundPhoto",accept:"image/*",className:"border border-gray-300 rounded-md p-2 w-full",onChange:C})]})]}),(0,s.jsxs)("div",{className:"mt-4 flex justify-end",children:[(0,s.jsx)("button",{onClick:k,className:" ".concat(o?"bg-yellow-400 text-black rounded hover:bg-yellow-600 hover:text-white":"bg-green-500 text-white rounded hover:bg-green-600"," px-4 py-2 transition duration-200"),children:"Update User"}),(0,s.jsx)("button",{onClick:()=>D(a.id),className:"ml-2 bg-red-500 text-white rounded px-4 py-2 hover:bg-red-600 transition duration-200",children:"Delete User"}),(0,s.jsx)("button",{onClick:()=>{i(!1),c(!1)},className:"ml-2 bg-gray-300 text-gray-700 rounded px-4 py-2 hover:bg-gray-400 transition duration-200",children:"Close"})]})]})})]})}},1163:function(e,t,a){e.exports=a(3079)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=3259)}),_N_E=e.O()}]);